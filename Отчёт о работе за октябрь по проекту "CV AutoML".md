## Установка системы
Для запуска системы на своём компьютере сделайте следующее:
1) Скачайте архив `CV_AutoML.zip`
2) Установите python 3.10.14 с официального сайта. Если у вас уже есть установленный python другой версии, можете воспользоваться pyenv для установки дополнительной версии 
   ([https://github.com/pyenv/pyenv](https://github.com/pyenv/pyenv))
4) Установите poetry [https://python-poetry.org/docs/](https://python-poetry.org/docs/)
5) Перейдите в корень разархивированной директории и скачайте необходимые для работы системы пакеты. Для этого запустите команду `poetry install`

- - -
## ALS
Алгоритм ALS позволяет нам заполнить непосчитанные данные о качестве работы моделей, предсказывая значения в таблице, где каждая строка обозначает один из бекбоунов, а каждый столбец — одну из голов (один из дешифровщиков)

Чтобы запустить подсчёт предсказаний, перейдите впапку scripts и запустите команду
`poetry run python3 als.py train`

> [!tip] Опции
> 
> При желании можно дописать количество эпох (до 10) с помощью опции `--epoch=6`, а также домен ("aerophoto" или "medical") через опцию `--domain="medical"`
> 
> Так, команда
> `poetry run python3 als.py train --epoch=10 --domain="medical"`
> Запустит обучение ALS на результатах за 10 эпох в медицинском домене

Этот скрипт соберёт все бекбоуны и головы в системе (прошу заметить, что в данный момент не все головы и бекбоуны переписаны под обновлённую инфраструктуру и поэтому в ближайшее время их количество повысится)

![[Pasted image 20241029170539.png]]

Каждое значение в этом датасете — посчитанное качество для модели, состоящей из соответствующих бекбоуна и головы, на 5 эпохах обучения. 
> [!tip] Где лежит информация об обучении?
> 
> Чтобы убедиться в корректности этих цифр, можно обратиться к обширному количеству JSON-ов в папке `data` — в них мы сохранили большое количество данных о запусках моделей.

Далее алгоритм ALS обучает векторные представления каждого бекбоуна и головы, для наглядности рисуя шкалу прогресса
![[Pasted image 20241029170848.png]]

Наконец, на основе обучения строится иллюстрация.
![[Pasted image 20241029170941.png]]

Здесь белыми значениями в таблице указаны изначальные данные, синими указаны предсказанные значения, а красным показана ошибка на тех элементах, у которых известно реальное качество

Зелёным обозначены векторные представления для каждого элемента. В самом низу указана функция ошибки. Как мы видим, она совсем невелика.

> [!question] Где лежат результаты?
> Результаты подсчёта ALS вы можете увидеть в папке `data/als` корня проекта. Точное название файла с сохраненными векторными представлениями выведено на экран в самом конце

> [!question] Где лежит исходный код?
> Внутри файла `scripts/als.py` и директории `lib/performance_prediction/als`

- - -
## Бустинг

Алгоритм бустинга также позволяет нам предсказывать качество модели, но в данном случае используя признаки поставленной задачи — яркость изображений, размер датасета, информация о предполагаемой модели. В дальнейшем этот список признаков пополнится векторными представлениями, получаемыми из алгоритма ALS

Для того чтобы обучить этот алгоритм, необходимо подать ему на вход множество примеров данных из нашего зоопарка датасетов — для этого скачайте файлы из прилагаемого источника и положите в папку datasets в корне репозитория
![[Pasted image 20241029191053.png]]

Для запуска демонстрации достаточно иметь папки `EuroSAT-slassification`, `chest-xray-pheumonia-classification` и `brain-tumor-mri-classification`
### Обучение

Вы можете начать обучение модели путём запуска команды `poetry run python3 boosting.py train`, которая начнётся с предобработки датасетов и получения из них ценных признаков

![[Pasted image 20241029181330.png]]

После обработки датасетов запустится процедура оптимизации параметров бустинга

![[Pasted image 20241029181521.png]]

После чего модель сохранится в указанную директорию
![[Pasted image 20241029181542.png]]

В репозитории уже содержится предобученная модель по указанному пути, поэтому этот шаг необязателен
### Предсказание

Для того, чтобы предсказать наилучшую модель для конкретного датасета, его необходимо передать в функцию predict. Для этого из папки `scripts` необходимо запустить команду `poetry run python3 boosting.py predict`, которая запустит процесс предсказания. 

Заметим, что для целей презентации используются 3 набора данных:
	- MRI (https://www.kaggle.com/datasets/masoudnickparvar/brain-tumor-mri-dataset/data)
	- chest-xray-pneumonia (https://huggingface.co/datasets/hf-vision/chest-xray-pneumonia)
	- EuroSAT (https://paperswithcode.com/dataset/eurosat)
По умолчанию выбирается датасет "MRI", но вы можете выбрать его, указав дополнительную опцию `data`, возможные значения которой `--data="mri"`, `--data="eurosat"` и `--data="chest"`

При выполнении этой команды у выбранного датасета также собираются признаки, после чего выдаётся модель (бекбоун + голова), которая по мнению алгоритма решит задачу лучше всего!
![[Pasted image 20241029183556.png]]

- - -

## Результаты работы моделей детекции

Результаты представлены в файле `Detection_results.pdf`