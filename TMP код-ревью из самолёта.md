## gribov tests

![[Pasted image 20240913130736.png]]
>[!quote] 
>Надо переделать концепцию метрики. Подвязать под BaseMetric — это отдельная задача

![[Pasted image 20240913142436.png]]
>[!quote] 
>Круто, что ты интегрировал sanity check в init! Я думаю в дальнейшем мы можем обязать разработчика во всех базовых классах реализовывать метод sanity_check, в котором должно происходить что-то вроде тобою написанного

![[Pasted image 20240913142923.png]]
>[!quote]
>При этом важно проследить за следующим — мы и так используем type hinting, и в этом плане статический анализатор наругается, если в функцию сможет попадать объект не того типа. Так что я не вижу кейса при котором нам надо дополнительно проверять выполнен ли type hinting (при этом проверка check_criterion_possibility_mapping уместна и не следует просто из соблюдения типов). В общем давай подумаем над этим — если ты видишь кейс где проверка типов нам поможет, давай её писать. Если нет, то это мб излишне

![[Pasted image 20240913143735.png]]
>[!warning]
>Не очень понимаю что здесь происходит с точки зрения синтаксиса. Надо проверить его на корректность

![[Pasted image 20240913143852.png]]
>[!quote]
>Если мы разрешаем int, то надо во-первых понять для каких метрик это нужно, а во-вторых добавить int в type hinting

![[Pasted image 20240913144407.png]]
>[!quote]
>Расскажи, в чём суть этого possibility? Разве любая модель поддерживает не любое количество итераций?

![[Pasted image 20240913150813.png]]
>[!quote]
>Разве это не должно быть фикстурой? Дальше ты её создаёшь, но не совсем понятно, зачем используешь это как глобальную переменную. Можно ведь фикстуры в фикстуры передавать

![[Pasted image 20240913151010.png]]
>[!quote]
>Потребовалась пара секунд чтобы понять что NclassesC это не опечатка в последней букве. Давай поподробнее называть функции, желательно полными словами

![[Pasted image 20240913151249.png]]
>[!quote]
>То же — воспользуйся вложенностью фикстур, глобальные переменные здесь выглядят костылём
>

>[!quote]
>Если не считать мои (вполне минорные) замечания, написано всё отлично! Тестов много, они в меру (и иногда через меру) дотошные. Часть из них лежит отдельными тестами, часть запускается сразу при создании объекта. Хорошая работа) 


## Add trainers etc.

![[Pasted image 20240913130959.png]]
>[!warning]
>Почему конфиг pre-commit? Сначала разобраться самому, потом спросить Санджара

  
![[Pasted image 20240913131132.png]]
  >[!quote] 
  >По идее модель ничего не должна знать про логгер, это не её область ответственности. Логгер выбирается на этапе конструирования пайплайна.
  >Также надо подумать над более универсальной папкой, чем твой хомяк. Либо подтягивать текущую директорию пользователя, либо сохранять всегда в независимую от пользователя папку
  >
  
![[Pasted image 20240913131619.png]]
 >[!quote]
  > Что такое train_dataset? Датасет, на котором предобучалась модель с нашими весами? Тогда боюсь у нас будут не все такие датасеты в директории. Кажется что это что-то другое
  > 
  > Что такое valid_dataset? Пример датасета, на котором модель даёт адекватное качество?
  > 
  > Что такое train_dataset? Что такое example dataset?
  > 
  > Туда же: почему модель сама выбирает, какой у неё device? Это же тоже не её ответственность.

![[Pasted image 20240913132319.png]]
>[!quote]
>Про метрики та же история — по идее это не забота модели

![[Pasted image 20240913132431.png]]
>[!quote]
>По идее частота логирования и валидации это тоже не ответстветнность модели. Но мб пока стоит и так оставить. В конечном счёте у нас по-хорошему должен быть конфиг для датасета и трейнера отдельно


![[Pasted image 20240913133209.png]]
>[!quote]
> Опять же, мы можем задать collate_fn только зная датасет, который нам дадут, но никак не используя предзаписанный в конфиг модели

![[Pasted image 20240913134011.png]]
>[!quote]
>Разве нам нужно это possibility? Всё равно критерий всегда выполняется

![[Pasted image 20240913134213.png]]
>[!quote]
>Объясни, зачем нам это нужно?

![[Pasted image 20240913134552.png]]
> [!quote]
> Давай уберём у txt логгера печать на экран, это тоже не его ответственность. Пусть лучше этим занимается отдельный тривиальный логгер (условный stdout logger). А я в свою очередь в пайплайне объединю их вывод в один composite-логгер

![[Pasted image 20240913134800.png]]
>[!quote]
>Как будто правильнее прокидывать таску не строкой а enum-ом

![[Pasted image 20240913134942.png]]
>[!quote]
>close не вызывается нигде в классе

![[Pasted image 20240913135257.png]]
>[!quote]
>Давай добавим sanity check проверку с ValueError в случае если smooth вне области возможных значений

![[Pasted image 20240913135549.png]]
>[!quote]
>Тоже было бы неплохо иметь sanity check на параметры

![[Pasted image 20240913135646.png]]
>[!quote]
>Предложение : loss должен знать про тип(ы) задач, к которым он применим. Давай добавим это поле в BaseLoss, а я на этапе проверки пайплайна на всякий буду смотреть, действительно ли метрика подходит под поставленный тип задачи

![[Pasted image 20240913140055.png]]
>[!quote]
>Здесь возникнет доп.трудность в рантайме определять маппинг из той метрики, которую указал пользователь в тот строковый ключ, который эту метрику даёт. Я бы в качестве ключей здесь прямо использовал ENUM-ы, чтобы значение метрики получалось напрямую по ключу, равному требуемой enum-метрике


![[Pasted image 20240913140456.png]]
> [!quote]
> Здесь все модели означает прям ВСЕ модели :) Поэтому не имеет смысла прокидывать специфический модуль и базовый класс, потому что базовый класс это BaseModel, а модули надо не выбирать, а брать все сразу. Поэтому когда дописываешь новый модуль с моделями, просто пополняй им attributes (ну а если у тебя появляются новые базовые классы, добавляй их в фильтр)

![[Pasted image 20240913140821.png]]
>[!warning]
>Проверить при появлении интернета

![[Pasted image 20240913140910.png]]
>[!warning]
>Проверить при появлении интернета

![[Pasted image 20240913141144.png]]
>[!quote]
>Этот код точно должен быть в configs.py? Название файла подсказывает обратное)

>[!error]
>Разобраться в том, что такое 
>- SMP
>- FocalLoss
>- Посмотреть на tensorboard

![[Pasted image 20240913141627.png]]
>[!quote]
>Здесь для единообразия лучше использовать не argparser, а fire

![[Pasted image 20240913141732.png]]
>[!quote]
>Это должно идти в репу? Надо спросить у Санджара роль этого объекта

![[Pasted image 20240913141807.png]]
>[!quote]
>А это?)


